<div class="vouchers-page">
  <div class="page-header">
    <div class="header-content">
      <h1>๐ ุณูุฏุงุช ุงููุจุถ</h1>
      <p class="subtitle">ุฅุฏุงุฑุฉ ุณูุฏุงุช ุงููุจุถ ุงูููุฏูุฉ ูุงูุจูููุฉ</p>
    </div>
  </div>

  <div class="toolbar">
    <div class="search-box">
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="searchVouchers()"
        placeholder="ุงูุจุญุซ ูู ุงูุณูุฏุงุช..."
        class="search-input"
      />
      <span class="search-icon">๐</span>
    </div>
    <button class="btn-primary" (click)="openModal()">
      โ ุฅุถุงูุฉ ุณูุฏ ูุจุถ
    </button>
  </div>

  <div class="vouchers-table" *ngIf="filteredVouchers.length > 0">
    <table>
      <thead>
        <tr>
          <th>ุฑูู ุงูุณูุฏ</th>
          <th>ุงูุชุงุฑูุฎ</th>
          <th>ุงูููุน</th>
          <th>ุงูุตูุฏูู/ุงูุจูู</th>
          <th>ุงููุณุชูู ูู</th>
          <th>ุงูุญุณุงุจ</th>
          <th>ุงููุจูุบ</th>
          <th>ุงูุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let voucher of filteredVouchers">
          <td><strong>{{ voucher.voucherNumber }}</strong></td>
          <td>{{ voucher.date | date:'yyyy-MM-dd' }}</td>
          <td>
            <span class="badge" [class.badge-cash]="voucher.paymentMethod === 'cash'" [class.badge-bank]="voucher.paymentMethod === 'bank'">
              {{ voucher.paymentMethod === 'cash' ? '๐ต ููุฏู' : '๐ฆ ุจููู' }}
            </span>
          </td>
          <td>{{ getSourceName(voucher) }}</td>
          <td>{{ voucher.beneficiary }}</td>
          <td>{{ voucher.account?.name || '-' }}</td>
          <td><strong>{{ voucher.amount | number:'1.2-2' }} ุฑ.ู</strong></td>
          <td>
            <button class="btn-icon" (click)="openModal(voucher)" title="ุชุนุฏูู">โ๏ธ</button>
            <button class="btn-icon" (click)="deleteVoucher(voucher.id)" title="ุญุฐู">๐๏ธ</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="empty-state" *ngIf="filteredVouchers.length === 0">
    <div class="empty-icon">๐</div>
    <h3>ูุง ุชูุฌุฏ ุณูุฏุงุช ูุจุถ</h3>
    <p>ูู ุจุฅุถุงูุฉ ุฃูู ุณูุฏ ูุจุถ</p>
    <button class="btn-primary" (click)="openModal()">ุฅุถุงูุฉ ุณูุฏ ูุจุถ</button>
  </div>
</div>

<!-- Modal -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal-content large" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ isEditMode ? 'ุชุนุฏูู ุณูุฏ ูุจุถ' : 'ุฅุถุงูุฉ ุณูุฏ ูุจุถ ุฌุฏูุฏ' }}</h2>
      <button class="btn-close" (click)="closeModal()">โ</button>
    </div>
    
    <div class="modal-body">
      <div class="form-row">
        <div class="form-group">
          <label>ููุน ุงูุณูุฏ *</label>
          <select [(ngModel)]="currentVoucher.paymentMethod" (change)="onPaymentMethodChange()" class="form-control">
            <option value="cash">๐ต ููุฏู</option>
            <option value="bank">๐ฆ ุจููู</option>
          </select>
        </div>
        
        <div class="form-group" *ngIf="currentVoucher.paymentMethod === 'cash'">
          <label>ุงูุตูุฏูู *</label>
          <select [(ngModel)]="currentVoucher.cashBoxId" (change)="onSourceChange()" class="form-control" required>
            <option [value]="null">ุงุฎุชุฑ ุตูุฏูู...</option>
            <option *ngFor="let box of cashBoxes" [value]="box.id">
              {{ box.name }} ({{ box.code }})
            </option>
          </select>
        </div>
        
        <div class="form-group" *ngIf="currentVoucher.paymentMethod === 'bank'">
          <label>ุงูุจูู *</label>
          <select [(ngModel)]="currentVoucher.bankId" (change)="onSourceChange()" class="form-control" required>
            <option [value]="null">ุงุฎุชุฑ ุจูู...</option>
            <option *ngFor="let bank of banks" [value]="bank.id">
              {{ bank.name }} ({{ bank.code }})
            </option>
          </select>
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label>ุฑูู ุงูุณูุฏ</label>
          <input type="text" [(ngModel)]="currentVoucher.voucherNumber" class="form-control" readonly />
        </div>
        
        <div class="form-group">
          <label>ุงูุชุงุฑูุฎ *</label>
          <input type="date" [(ngModel)]="currentVoucher.date" class="form-control" required />
        </div>
      </div>
      
      <div class="form-group">
        <label>ุงูุญุณุงุจ (ุงูุฏุงุฆู) *</label>
        <select [(ngModel)]="currentVoucher.accountId" class="form-control" required>
          <option [value]="null">ุงุฎุชุฑ ุญุณุงุจ...</option>
          <option *ngFor="let account of accounts" [value]="account.id">
            {{ account.code }} - {{ account.name }}
          </option>
        </select>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label>ุงููุจูุบ *</label>
          <input type="number" [(ngModel)]="currentVoucher.amount" class="form-control" required min="0" step="0.01" />
        </div>
        
        <div class="form-group">
          <label>ุงููุณุชูู ูู *</label>
          <input type="text" [(ngModel)]="currentVoucher.beneficiary" class="form-control" required />
        </div>
      </div>
      
      <div class="form-group">
        <label>ุงูุจูุงู</label>
        <textarea [(ngModel)]="currentVoucher.description" class="form-control" rows="3"></textarea>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeModal()">ุฅูุบุงุก</button>
      <button class="btn-primary" (click)="saveVoucher()">
        {{ isEditMode ? 'ุชุญุฏูุซ' : 'ุญูุธ' }}
      </button>
    </div>
  </div>
</div>
